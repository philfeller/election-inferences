---
title: "Uncertainty in Voter Transition Estimates"
output: html_document
---

```{r setup, include=FALSE}
wd <- getwd()
setwd("../")
source("./global.R", local = TRUE)
source("./present.R", local = TRUE)
load("./1852_covariate_inference.Rda")
load("./1853_covariate_inference.Rda")
load("./1854_covariate_inference.Rda")
load("./1855_covariate_inference.Rda")
load("./1856_covariate_inference.Rda")
load("./1857_covariate_inference.Rda")
load("./maps.Rda")
setwd(dirname(wd))
```
Statistical models struggle to capture 1850s Connecticut voting behavior. Even after accounting for wealth, degree of urbanization, immigrant status, religious affiliation, and geographic location, the models produce unstable estimates—different runs yield substantively different conclusions about voter movement. This instability reveals something important: factors that resist quantification drove voting decisions. Personal relationships, local political culture, party organization, newspaper influence, and individual conviction don't appear in census records.

Note especially how badly the model performs in the 1854 to 1855 transition, particularly for explaining what became of Free Soil and Temperance voters and for explaining the composition of the Know Nothing coalition, precisely the information that we'd like to know. Also note how the model's failure isn't concentrated in any single part of the state, but is instead widespread, suggesting that the model is missing some important factor or factors that influenced voting behavior across the state.

Low values are better in both graphs. R-hat values above 1.1 indicate that the model has not converged—that different runs explore different ranges of possible outcomes—and the wider the flow intervals, the more uncertainty there is about the estimated voter transitions.

```{r plots, echo=FALSE}
knitr::opts_chunk$set(
  fig.width = 1,
  fig.height = 5,
  dpi = 300,
  dev = "png"
)
rhat_map.52 <- create_rhat_heatmap(variability_results.52$rhat)
range_map.52 <- create_transition_uncertainty_heatmap(variability_results.52$flow_intervals)
gridExtra::grid.arrange(rhat_map.52, range_map.52, ncol = 2)
rhat_map.53 <- create_rhat_heatmap(variability_results.53$rhat)
range_map.53 <- create_transition_uncertainty_heatmap(variability_results.53$flow_intervals)
gridExtra::grid.arrange(rhat_map.53, range_map.53, ncol = 2)
rhat_map.54 <- create_rhat_heatmap(variability_results.54$rhat)
range_map.54 <- create_transition_uncertainty_heatmap(variability_results.54$flow_intervals)
gridExtra::grid.arrange(rhat_map.54, range_map.54, ncol = 2)
rhat_map.55 <- create_rhat_heatmap(variability_results.55$rhat)
range_map.55 <- create_transition_uncertainty_heatmap(variability_results.55$flow_intervals)
gridExtra::grid.arrange(rhat_map.55, range_map.55, ncol = 2)
rhat_map.56 <- create_rhat_heatmap(variability_results.56$rhat)
range_map.56 <- create_transition_uncertainty_heatmap(variability_results.56$flow_intervals)
gridExtra::grid.arrange(rhat_map.56, range_map.56, ncol = 2)
rhat_map.57 <- create_rhat_heatmap(variability_results.57$rhat)
range_map.57 <- create_transition_uncertainty_heatmap(variability_results.57$flow_intervals)
gridExtra::grid.arrange(rhat_map.57, range_map.57, ncol = 2)
create_rhat_town_map(variability_results.55$rhat, map.55)
```