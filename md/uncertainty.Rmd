---
title: "Uncertainty in Voter Transition Estimates"
output: html_document
---

```{r setup, include=FALSE}
wd <- getwd()
setwd("../")
source("./global.R", local = TRUE)
source("./present.R", local = TRUE)
load("./1852_covariate_inference.Rda")
load("./1853_covariate_inference.Rda")
load("./1854_covariate_inference.Rda")
load("./1855_covariate_inference.Rda")
load("./1856_covariate_inference.Rda")
load("./1857_covariate_inference.Rda")
load("./maps.Rda")
setwd(dirname(wd))
```
The multinomial-Dirichlet model estimates voter transitions between parties by computationally exploring an enormous space of possible explanations. It does this by repeatedly drawing from probability distributions representing plausible voter behavior and comparing those draws against observed election outcomes. Given enough exploration, runs that begin from different random starting points should ultimately describe the same underlying pattern — they should "converge."

To guard against any single run becoming trapped in one region of that space, I ran the model ten times for each transition. Comparing those runs reveals whether they reached similar conclusions. They did not. Different runs produced substantively different estimates of voter movement, making it impossible to be confident in any particular account.

This instability is not merely a technical problem — it is a historical finding. If a consistent pattern of voter transfers existed and the available quantitative evidence captured it reasonably well, the runs would agree. The fact that they do not suggests that the residual variation is not random noise but structured local difference: different constituencies behaved differently in ways the model cannot reconcile into a single description. Even after accounting for wealth, degree of urbanization, immigrant status, religious affiliation, and geographic location, no stable common pattern emerges. Factors that resist quantification — personal relationships, political culture, party organization, localized contingency — do not appear in census records, but their effects appear here, in the model's failure to converge.

The two heatmaps display complementary evidence of this instability. The first shows maximum R-hat values for each transition: a measure of how differently the ten runs behaved. Values at or below 1.01 indicate confident convergence; values above 1.05 are cause for concern; values above 1.1 indicate that different runs explored meaningfully different ranges of outcomes. The second heatmap shows the spread between the highest and lowest transition estimates across runs — a direct measure of how much the substantive conclusions vary. In both cases, lower values indicate greater reliability.

```{r plots, echo=FALSE}
knitr::opts_chunk$set(
  fig.width = 1,
  fig.height = 5,
  dpi = 300,
  dev = "png"
)
rhat_map.52 <- create_rhat_heatmap(variability_results.52$rhat)
range_map.52 <- create_transition_uncertainty_heatmap(variability_results.52$flow_intervals)
gridExtra::grid.arrange(rhat_map.52, range_map.52, ncol = 2)
rhat_map.53 <- create_rhat_heatmap(variability_results.53$rhat)
range_map.53 <- create_transition_uncertainty_heatmap(variability_results.53$flow_intervals)
gridExtra::grid.arrange(rhat_map.53, range_map.53, ncol = 2)
rhat_map.54 <- create_rhat_heatmap(variability_results.54$rhat)
range_map.54 <- create_transition_uncertainty_heatmap(variability_results.54$flow_intervals)
gridExtra::grid.arrange(rhat_map.54, range_map.54, ncol = 2)
rhat_map.55 <- create_rhat_heatmap(variability_results.55$rhat)
range_map.55 <- create_transition_uncertainty_heatmap(variability_results.55$flow_intervals)
gridExtra::grid.arrange(rhat_map.55, range_map.55, ncol = 2)
rhat_map.56 <- create_rhat_heatmap(variability_results.56$rhat)
range_map.56 <- create_transition_uncertainty_heatmap(variability_results.56$flow_intervals)
gridExtra::grid.arrange(rhat_map.56, range_map.56, ncol = 2)
rhat_map.57 <- create_rhat_heatmap(variability_results.57$rhat)
range_map.57 <- create_transition_uncertainty_heatmap(variability_results.57$flow_intervals)
gridExtra::grid.arrange(rhat_map.57, range_map.57, ncol = 2)
create_rhat_town_map(variability_results.55$rhat, map.55)
```